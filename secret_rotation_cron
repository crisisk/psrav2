# OpenBao Secret Rotation Cron Job
# Place this file in /etc/cron.d/openbao-secret-rotation

# Set environment variables
SHELL=/bin/bash
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin
OPENBAO_ADDR=https://openbao.sevensa.nl

# Run database credential rotation daily at 1:00 AM
0 1 * * * root /etc/openbao/scripts/rotate_secrets.sh >> /var/log/openbao/secret_rotation.log 2>&1

# Run PKI certificate rotation monthly on the 1st at 2:00 AM
0 2 1 * * root ROTATION_CONFIG=/etc/openbao/pki_rotation_config.json /etc/openbao/scripts/rotate_secrets.sh >> /var/log/openbao/pki_rotation.log 2>&1

# Run transit key rotation quarterly at 3:00 AM on the 1st of Jan, Apr, Jul, Oct
0 3 1 1,4,7,10 * root ROTATION_CONFIG=/etc/openbao/transit_rotation_config.json /etc/openbao/scripts/rotate_secrets.sh >> /var/log/openbao/transit_rotation.log 2>&1
